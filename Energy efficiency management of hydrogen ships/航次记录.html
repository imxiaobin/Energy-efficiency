<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日报记录</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="js/common.js"></script>
    <style>
        /* 基础布局样式 */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e9f2 100%);
            gap: 11px;
            padding: 0 11px;
            box-sizing: border-box;
        }

        /* 侧边栏样式 */
        .sidebar {
            background: linear-gradient(135deg, #e8eef9 0%, #d4e2f9 100%);
            color: #2c3e50;
            padding: 25px;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            height: calc(100vh - 20px);
            z-index: 1;
            margin: 10px;
            margin-right: 0;
            margin-top: 10px;
            border-radius: 15px;
            position: relative;
            overflow-y: auto;
            width: 220px;
        }

        /* 侧边栏菜单项样式 */
        .sidebar .menu-item-wrap {
            cursor: pointer;
        }

        .sidebar .menu-item h2 {
            display: flex;
            align-items: center;
            font-size: 16px;
            color: #2c3e50;
            margin: 15px 0;
            padding: 12px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.7);
        }

        /* 为每个菜单项添加图标 */
        .sidebar .menu-item h2::before {
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        /* 为每个菜单项添加特定图标 */
        #menuItem0 h2::before {
            content: "\f54b";  /* 船舶图标 */
            color: #3498db;
        }

        #menuItem1 h2::before {
            content: "\f080";  /* 记录图标 */
            color: #2ecc71;
        }

        #menuItem2 h2::before {
            content: "\f0e4";  /* 检测图标 */
            color: #e67e22;
        }

        #menuItem3 h2::before {
            content: "\f5eb";  /* 决策图标 */
            color: #e74c3c;
        }

        #menuItemReportGen h2::before {
            content: "\f15c";  /* 报告图标 */
            color: #9b59b6;
        }

        /* 修改子菜单项样式 */
        .sidebar .menu-item li {
            padding: 10px 15px 10px 45px;
            color: #4a5568;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 6px;
            margin: 2px 0;
            position: relative;
        }

        /* 为子菜单项添加小图标 */
        .sidebar .menu-item li::before {
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            content: "\f105";  /* 箭头图标 */
            position: absolute;
            left: 25px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* 悬停效果 */
        .sidebar .menu-item h2:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            transform: translateX(5px);
        }

        .sidebar .menu-item li:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            transform: translateX(5px);
        }

        /* 活动状态样式 */
        .sidebar .menu-item.active h2 {
            background: rgba(52, 152, 219, 0.15);
            color: #3498db;
        }

        /* 页眉样式 */
        header {
            background: linear-gradient(135deg, #e8eef9 0%, #d4e2f9 100%);
            color: #2c3e50;
            padding: 10px 20px;
            width: 100%;
            display: flex;
            flex-direction: column;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-top: 0;
            margin-bottom: 15px;
            z-index: 1;
            flex-shrink: 0;
        }

        /* 导航栏样式 */
        .navbar {
            display: flex;
            justify-content: flex-end;
            grid-column: 1 / -1;
        }

        .nav-list {
            display: flex;
            list-style: none;
            margin: 5px;
            padding: 10px;
            gap: 20px;
        }

        .nav-item {
            margin: 0;
        }

        .nav-item a {
            color: #2c3e50;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 16px;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.7);
        }

        .nav-item a:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            transform: translateY(-2px);
        }

        .nav-item a i {
            font-size: 18px;
        }

        /* 添加图标悬停效果 */
        .nav-item a:hover i {
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-3px);
            }
        }

        /* 主内容区域样式 */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            background-color: #ffffff;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
            border-radius: 15px;
            margin: 10px;
            margin-left: 20px;
            min-width: 0; /* 防止flex子项溢出 */
        }

        /* 搜索区域样式优化 */
        .search-area {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            padding: 30px;
            background: linear-gradient(145deg, #ffffff, #f5f7fa);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
            margin-bottom: 35px;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }

        .search-group {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.03);
        }

        .search-group-title {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e6ed;
        }

        .search-group-title i {
            font-size: 24px;
            color: #3498db;
        }

        .search-group-title span {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .search-fields {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .report-search-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .report-search-item label {
            min-width: 90px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 15px;
        }

        .report-search-item input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #e0e6ed;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .report-search-item input:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .date-range-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .date-range-container input[type="date"] {
            padding: 12px 15px;
            border: 1px solid #e0e6ed;
            border-radius: 10px;
            font-size: 14px;
        }

        .date-separator {
            color: #2c3e50;
            font-weight: 500;
        }

        .search-actions {
            grid-column: 1 / -1;
            display: flex;
            justify-content: flex-end;
            padding-top: 20px;
        }

        .search-btn {
            padding: 12px 35px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        /* 表格区域样式优化 */
        .table-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e6ed;
        }

        .table-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .table-title i {
            font-size: 24px;
            color: #3498db;
        }

        .table-title span {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }

        .table-actions {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .import-btn {
            background: linear-gradient(135deg, #28a745, #218838);
        }

        .export-btn {
            background: linear-gradient(135deg, #17a2b8, #138496);
        }

        .add-btn {
            background: linear-gradient(135deg, #007bff, #0056b3);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        /* 表格样式优化 */
        .table-scroll-container {
            margin: 20px 0;
            border-radius: 15px;
            overflow-x: auto;
            overflow-y: hidden;
            scrollbar-width: thin;
            scrollbar-color: #3498db #f8fafc;
        }

        .table-scroll-container table {
            min-width: 1500px;
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .table-scroll-container::-webkit-scrollbar {
            height: 8px;
        }

        .table-scroll-container::-webkit-scrollbar-track {
            background: #f8fafc;
            border-radius: 4px;
        }

        .table-scroll-container::-webkit-scrollbar-thumb {
            background: #3498db;
            border-radius: 4px;
        }

        .table-scroll-container::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }

        th {
            background: #f8fafc;
            padding: 15px 20px;
            font-weight: 600;
            color: #2c3e50;
            text-align: left;
            border-bottom: 2px solid #e2e8f0;
            white-space: nowrap;
        }

        td {
            padding: 15px 20px;
            color: #4a5568;
            border-bottom: 1px solid #e2e8f0;
        }

        tr:hover td {
            background: #f8fafc;
        }

        /* 分页控件样式优化 */
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-top: 20px;
            border-top: 2px solid #e0e6ed;
        }

        .pagination-info {
            color: #2c3e50;
            font-size: 14px;
        }

        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .page-btn {
            padding: 8px 16px;
            border: 1px solid #e0e6ed;
            border-radius: 8px;
            background: white;
            color: #2c3e50;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn:hover {
            background: #f8fafc;
            border-color: #3498db;
            color: #3498db;
        }

        .page-jump {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .page-jump input {
            width: 60px;
            padding: 8px;
            border: 1px solid #e0e6ed;
            border-radius: 8px;
            text-align: center;
        }

        .jump-btn {
            padding: 8px 16px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .jump-btn:hover {
            background: #2980b9;
        }

        .page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #2c3e50;
        }

        .page-size-selector select {
            padding: 8px;
            border: 1px solid #e0e6ed;
            border-radius: 8px;
            cursor: pointer;
        }

        /* 操作按钮样式优化 */
        .operation-btns {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .operation-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-btn {
            background: #ffc107;
            color: #000;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
        }

        .operation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        /* 侧边栏无序列表（ul）式 */
        .sidebar ul {
            list-style-type: none;
            padding: 0;
            margin-top: 0px;
        }

        /* 侧边栏列表项（li）通用样式 */
        .sidebar ul li {
            font-weight: bold;
            margin-bottom: 1px;
            padding: 3px 0;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        /* 修改侧边栏菜单项的悬停效果 */
        .sidebar .menu-item-wrap {
            cursor: pointer;
        }

        .sidebar .menu-item h2 {
            display: flex;
            align-items: center;
            font-size: 18px;
            color: #2c3e50;
            margin: 15px 0;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        /* 修改标题悬停效果 */
        .sidebar .menu-item h2:hover {
            color: #3c63ac;
            transform: scale(1.05);
            background: rgba(60, 99, 172, 0.1);
        }

        /* 修改列表项悬停效果 */
        .sidebar .menu-item li {
            padding: 12px 20px 12px 40px;
            color: #666;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 6px;
            margin: 2px 0;
        }

        .sidebar .menu-item li:hover {
            color: #3c63ac;
            background: rgba(60, 99, 172, 0.1);
            transform: translateX(5px);
            padding-left: 45px;
        }

        /* 修改活动状态的菜单项样式 */
        .sidebar .menu-item.active h2 {
            color: #3c63ac;
            background: rgba(60, 99, 172, 0.1);
        }

        /* 删除之前冲突的悬停样式 */
        .sidebar .menu-item h2:hover,
        .sidebar .menu-item h2:focus {
            transform: scale(1.05);
        }

        .sidebar .menu-item li:hover,
        .sidebar .menu-item li:focus {
            transform: translateX(5px);
        }
    </style>
</head>
<body>
    <!-- 侧边栏部分 -->
    <div class="sidebar">
        <div class="menu-item" id="menuItem0">
            <div class="menu-item-wrap">
                <h2>船舶管理</h2>
                <ul id="menu0">
                    <li onclick="window.location.href='船舶信息管理.html'">船舶信息</li>
                </ul>
            </div>
        </div>

        <div class="menu-item" id="menuItem1">
            <div class="menu-item-wrap">
                <h2>信息记录</h2>
                <ul id="menu1">
                    <li onclick="window.location.href='日报记录.html'">日报记录</li>
                    <li onclick="window.location.href='航次记录.html'">航次记录</li>
                    <li onclick="window.location.href='储氢罐记录.html'">储氢罐记录</li>
                    <li onclick="window.location.href='加氢记录.html'">加氢记录</li>
                    <li onclick="window.location.href='在线监测记录.html'">在线监测记录</li>
                </ul>
            </div>
        </div>
        
        <div class="menu-item" id="menuItem2">
            <div class="menu-item-wrap">
                <h2>能效分析</h2>
                <ul id="menu2">
                    <li onclick="window.location.href='能耗统计.html'">能耗统计</li>
                    <li onclick="window.location.href='性能分析.html'">性能分析</li>
                    <li onclick="window.location.href='能效计算器.html'">能效计算器</li>
                    <li onclick="window.location.href='能效提升预测.html'">能效提升预测</li>
                </ul>
            </div>
        </div>
        
        <div class="menu-item" id="menuItem3">
            <div class="menu-item-wrap">
                <h2>报表管理</h2>
                <ul id="menu3">
                    <li onclick="window.location.href='能耗记录表.html'">能耗记录表</li>
                    <li onclick="window.location.href='能效管理计划.html'">能效管理计划</li>
                    <li onclick="window.location.href='自定义报表.html'">自定义报表</li>
                </ul>
            </div>
        </div>
        
        <div class="menu-item" id="menuItemReportGen">
            <div class="menu-item-wrap">
                <h2>在职人员管理</h2>
                <ul id="reportGen">
                    <li onclick="window.location.href='在职人员信息.html'">在职人员信息</li>
                    <li onclick="window.location.href='当值记录表.html'">当值记录表</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 主内容区域 -->
    <div class="main-content">
        <!-- 页眉部分 -->
        <header>
            <div class="header-content">
                <nav class="navbar">
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" title="首页">
                                <i class="fas fa-home"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" title="数据分析">
                                <i class="fas fa-chart-line"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" title="设置">
                                <i class="fas fa-cog"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" title="用户">
                                <i class="fas fa-user"></i>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- 搜索区域 -->
        <div class="search-area">
            <div class="search-group">
                <div class="search-group-title">
                    <i class="fas fa-ship"></i>
                    <span>船舶基本信息</span>
                </div>
                <div class="search-fields">
                    <div class="report-search-item">
                        <label>船名：</label>
                        <input type="text" placeholder="请输入船名">
                    </div>
                    <div class="report-search-item">
                        <label>航次号：</label>
                        <input type="text" placeholder="请输入航次号">
                    </div>
                </div>
            </div>
            <div class="search-group">
                <div class="search-group-title">
                    <i class="fas fa-route"></i>
                    <span>航行信息</span>
                </div>
                <div class="search-fields">
                    <div class="report-search-item">
                        <label>出发港：</label>
                        <input type="text" placeholder="请输入出发港口">
                    </div>
                    <div class="report-search-item">
                        <label>目的港：</label>
                        <input type="text" placeholder="请输入目的港口">
                    </div>
                </div>
            </div>
            <div class="search-group">
                <div class="search-group-title">
                    <i class="fas fa-calendar-alt"></i>
                    <span>时间范围</span>
                </div>
                <div class="search-fields">
                    <div class="report-search-item">
                        <label>航次日期：</label>
                        <div class="date-range-container">
                            <input type="date" id="startDate">
                            <span class="date-separator">至</span>
                            <input type="date" id="endDate">
                        </div>
                    </div>
                </div>
            </div>
            <div class="search-actions">
                <button class="search-btn" onclick="searchVoyages()">
                    <i class="fas fa-search"></i>
                    搜索
                </button>
            </div>
        </div>

        <!-- 表格区域 -->
        <div class="table-container">
            <div class="table-header">
                <div class="table-title">
                    <i class="fas fa-ship"></i>
                    <span>氢能船舶航次记录列表</span>
                </div>
                <div class="table-actions">
                    <button class="action-btn import-btn" onclick="importVoyageData()">
                        <i class="fas fa-file-import"></i>
                        导入航次信息
                    </button>
                    <button class="action-btn export-btn" onclick="exportVoyageData()">
                        <i class="fas fa-file-export"></i>
                        导出航次信息
                    </button>
                    <button class="action-btn add-btn" onclick="showAddVoyageDialog()">
                        <i class="fas fa-plus"></i>
                        新增航次记录
                    </button>
                </div>
            </div>
            
            <div class="table-scroll-container">
                <table>
                    <thead>
                        <tr>
                            <th>船名</th>
                            <th>航次号</th>
                            <th>出发时间</th>
                            <th>抵达时间</th>
                            <th>出发港</th>
                            <th>目的港</th>
                            <th>航程(海里)</th>
                            <th>氢耗总量(kg)</th>
                            <th>平均氢耗(kg/h)</th>
                            <th>燃料电池效率(%)</th>
                            <th>能量利用率(%)</th>
                            <th>加氢次数</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="voyageTableBody">
                        <!-- 示例数据 -->
                        <tr>
                            <td>氢能1号</td>
                            <td>HV20240101</td>
                            <td>2024-01-01 08:00</td>
                            <td>2024-01-02 16:00</td>
                            <td>上海港</td>
                            <td>宁波港</td>
                            <td>120</td>
                            <td>850</td>
                            <td>26.5</td>
                            <td>55.8</td>
                            <td>62.3</td>
                            <td>2</td>
                            <td>
                                <div class="operation-btns">
                                    <button class="operation-btn edit-btn" title="编辑">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="operation-btn delete-btn" title="删除">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <!-- 更多数据行... -->
                    </tbody>
                </table>
            </div>

            <!-- 分页控件 -->
            <div class="pagination-container">
                <div class="pagination-info">
                    <span>共 <span id="totalPages">10</span> 页，</span>
                    <span><span id="totalRecords">100</span> 条记录</span>
                </div>
                <div class="pagination-controls">
                    <button class="page-btn" onclick="goToFirstPage()">首页</button>
                    <button class="page-btn" onclick="goToPrevPage()">上一页</button>
                    <div class="page-jump">
                        <span>第</span>
                        <input type="number" id="jumpPageInput" min="1" value="1">
                        <span>页</span>
                        <button class="jump-btn" onclick="jumpToPage()">跳转</button>
                    </div>
                    <button class="page-btn" onclick="goToNextPage()">下一页</button>
                    <button class="page-btn" onclick="goToLastPage()">末页</button>
                </div>
                <div class="page-size-selector">
                    <span>每页显示：</span>
                    <select onchange="changePageSize(this.value)">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                    </select>
                    <span>条</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 设置默认期
            const today = new Date();
            document.getElementById('startDate').valueAsDate = today;
            document.getElementById('endDate').valueAsDate = today;
            
            // 初始化表格数据
            loadTableData();
        });

        // 加载表格数据
        function loadTableData() {
            // 这里添加加载数据的逻辑
        }

        // 搜索功能
        function searchReports() {
            // 这里添加搜索逻辑
        }

        // 导入导出功能
        function importDailyReport() {
            // 这里添加导入逻辑
        }

        function exportDailyReport() {
            // 这里添加导出逻辑
        }

        // 分页功能
        function goToFirstPage() {
            // 这里添加首页逻辑
        }

        function goToPrevPage() {
            // 这里添加上一页逻辑
        }

        function goToNextPage() {
            // 这里添加下一页逻辑
        }

        function goToLastPage() {
            // 这里添加末页逻辑
        }

        function changePageSize(size) {
            // 这里添加改变页面大小的逻辑
        }

        // 修改侧边栏动画效果
        document.addEventListener('DOMContentLoaded', function() {
            // 获取所有菜单项
            const menuItems = document.querySelectorAll('.menu-item');
            
            menuItems.forEach(item => {
                const title = item.querySelector('h2');
                if (title) {
                    title.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const menuId = item.querySelector('ul')?.id;
                        if (menuId) {
                            toggleMenuItem(menuId);
                        }
                    });
                }
            });
        });

        // 菜单切换函数
        function toggleMenuItem(menuId) {
            const menuItems = document.querySelectorAll('.menu-item');
            const targetMenuItem = document.getElementById(menuId).closest('.menu-item');
            
            if (targetMenuItem.classList.contains('active')) {
                targetMenuItem.classList.remove('active');
                const subMenu = targetMenuItem.querySelector('ul');
                if (subMenu) {
                    subMenu.style.maxHeight = '0';
                }
                return;
            }
            
            // 关闭其他打开的菜单项
            menuItems.forEach(item => {
                if (item !== targetMenuItem) {
                    item.classList.remove('active');
                    const subMenu = item.querySelector('ul');
                    if (subMenu) {
                        subMenu.style.maxHeight = '0';
                    }
                }
            });
            
            // 打开目标菜单项
            targetMenuItem.classList.add('active');
            const subMenu = targetMenuItem.querySelector('ul');
            if (subMenu) {
                subMenu.style.maxHeight = subMenu.scrollHeight + 'px';
            }
        }

        // 导入航次信息
        function importVoyageData() {
            // 创建文件输入元素
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.xlsx,.xls,.csv';
            
            fileInput.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        // 这里可以添加处理Excel或CSV文件的逻辑
                        // 可以使用库如 SheetJS 来处理
                        alert('文件导入成功！');
                        // 刷新表格数据
                        loadTableData();
                    } catch (error) {
                        alert('文件导入失败：' + error.message);
                    }
                };
                reader.readAsArrayBuffer(file);
            };
            
            fileInput.click();
        }

        // 导出航次信息
        function exportVoyageData() {
            // 获取表格数据
            const table = document.querySelector('table');
            const rows = Array.from(table.querySelectorAll('tr'));
            
            // 构建CSV内容
            let csvContent = "data:text/csv;charset=utf-8,";
            
            rows.forEach(row => {
                const cells = Array.from(row.querySelectorAll('th, td'));
                const rowData = cells.map(cell => {
                    // 排除操作列的按钮
                    if (cell.querySelector('.operation-btns')) {
                        return '';
                    }
                    return '"' + (cell.textContent || '').trim() + '"';
                }).join(',');
                csvContent += rowData + '\n';
            });
            
            // 创建下载链��
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', `航次记录_${new Date().toLocaleDateString()}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // 显示新增航次记录对话框
        function showAddVoyageDialog() {
            // 创建对话框HTML
            const dialogHTML = `
                <div id="addVoyageDialog" class="dialog-overlay">
                    <div class="dialog-content">
                        <h2>新增航次记录</h2>
                        <form id="addVoyageForm">
                            <div class="form-group">
                                <label>船名：</label>
                                <input type="text" name="shipName" required>
                            </div>
                            <div class="form-group">
                                <label>航次号：</label>
                                <input type="text" name="voyageNumber" required>
                            </div>
                            <div class="form-group">
                                <label>出发时间：</label>
                                <input type="datetime-local" name="departureTime" required>
                            </div>
                            <div class="form-group">
                                <label>抵达时间：</label>
                                <input type="datetime-local" name="arrivalTime" required>
                            </div>
                            <div class="form-group">
                                <label>出发港：</label>
                                <input type="text" name="departurePort" required>
                            </div>
                            <div class="form-group">
                                <label>目的港：</label>
                                <input type="text" name="destinationPort" required>
                            </div>
                            <div class="form-group">
                                <label>航程(海里)：</label>
                                <input type="number" name="distance" required>
                            </div>
                            <div class="form-group">
                                <label>氢耗总量(kg)：</label>
                                <input type="number" name="hydrogenConsumption" required>
                            </div>
                            <div class="form-group">
                                <label>平均氢耗(kg/h)：</label>
                                <input type="number" name="avgHydrogenConsumption" required>
                            </div>
                            <div class="form-group">
                                <label>燃料电池效率(%)：</label>
                                <input type="number" name="fuelCellEfficiency" required>
                            </div>
                            <div class="form-group">
                                <label>能量利用率(%)：</label>
                                <input type="number" name="energyEfficiency" required>
                            </div>
                            <div class="form-group">
                                <label>加氢次数：</label>
                                <input type="number" name="refuelingCount" required>
                            </div>
                            <div class="dialog-buttons">
                                <button type="submit" class="submit-btn">保存</button>
                                <button type="button" class="cancel-btn" onclick="closeAddVoyageDialog()">取消</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            // 添加对话框样式
            const dialogStyle = `
                <style>
                    .dialog-overlay {
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0, 0, 0, 0.5);
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        z-index: 1000;
                    }
                    
                    .dialog-content {
                        background: white;
                        padding: 30px;
                        border-radius: 15px;
                        max-width: 500px;
                        width: 90%;
                        max-height: 90vh;
                        overflow-y: auto;
                    }
                    
                    .form-group {
                        margin-bottom: 15px;
                    }
                    
                    .form-group label {
                        display: block;
                        margin-bottom: 5px;
                        font-weight: bold;
                    }
                    
                    .form-group input {
                        width: 100%;
                        padding: 8px;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                    }
                    
                    .dialog-buttons {
                        margin-top: 20px;
                        display: flex;
                        justify-content: flex-end;
                        gap: 10px;
                    }
                    
                    .submit-btn, .cancel-btn {
                        padding: 8px 20px;
                        border: none;
                        border-radius: 4px;
                        cursor: pointer;
                    }
                    
                    .submit-btn {
                        background: #3498db;
                        color: white;
                    }
                    
                    .cancel-btn {
                        background: #95a5a6;
                        color: white;
                    }
                </style>
            `;
            
            // 添加到文档
            document.body.insertAdjacentHTML('beforeend', dialogStyle + dialogHTML);
            
            // 添加表单提交处理
            document.getElementById('addVoyageForm').onsubmit = function(e) {
                e.preventDefault();
                const formData = new FormData(e.target);
                const voyageData = Object.fromEntries(formData.entries());
                
                // 这里可以添加数据验证逻辑
                
                // 添加到表格
                addVoyageToTable(voyageData);
                
                // 关闭对话框
                closeAddVoyageDialog();
            };
        }

        // 关闭新增航次记录对话框
        function closeAddVoyageDialog() {
            const dialog = document.getElementById('addVoyageDialog');
            if (dialog) {
                dialog.remove();
            }
        }

        // 添加航次记录到表格
        function addVoyageToTable(voyageData) {
            const tbody = document.getElementById('voyageTableBody');
            const newRow = document.createElement('tr');
            
            newRow.innerHTML = `
                <td>${voyageData.shipName}</td>
                <td>${voyageData.voyageNumber}</td>
                <td>${voyageData.departureTime}</td>
                <td>${voyageData.arrivalTime}</td>
                <td>${voyageData.departurePort}</td>
                <td>${voyageData.destinationPort}</td>
                <td>${voyageData.distance}</td>
                <td>${voyageData.hydrogenConsumption}</td>
                <td>${voyageData.avgHydrogenConsumption}</td>
                <td>${voyageData.fuelCellEfficiency}</td>
                <td>${voyageData.energyEfficiency}</td>
                <td>${voyageData.refuelingCount}</td>
                <td>
                    <div class="operation-btns">
                        <button class="operation-btn edit-btn" title="编辑">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="operation-btn delete-btn" title="删除">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            `;
            
            tbody.insertBefore(newRow, tbody.firstChild);
        }
    </script>
</body>
</html> 