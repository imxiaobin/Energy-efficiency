<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>储氢罐记录</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="js/common.js"></script>
    <style>
        /* 继承基础样式 */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e9f2 100%);
            gap: 11px;
            padding: 0 11px;
            box-sizing: border-box;
            overflow: hidden;
        }

        /* 侧边栏样式 */
        .sidebar {
            background: linear-gradient(135deg, #e8eef9 0%, #d4e2f9 100%);
            color: #2c3e50;
            padding: 25px;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            height: calc(100vh - 20px);
            z-index: 1;
            margin: 10px;
            margin-right: 0;
            margin-top: 10px;
            border-radius: 15px;
            position: relative;
            overflow-y: auto;
            width: 220px;
        }

        /* 侧边栏菜单项样式 */
        .sidebar .menu-item-wrap {
            cursor: pointer;
        }

        .sidebar .menu-item h2 {
            display: flex;
            align-items: center;
            font-size: 16px;
            color: #2c3e50;
            margin: 15px 0;
            padding: 12px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.7);
        }

        /* 添加图标到菜单项 */
        .sidebar .menu-item h2::before {
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        /* 为每个菜单项添加特定图标 */
        #menuItem0 h2::before {
            content: "\f54b";  /* 船舶图标 */
            color: #3498db;
        }

        #menuItem1 h2::before {
            content: "\f080";  /* 记录图标 */
            color: #2ecc71;
        }

        #menuItem2 h2::before {
            content: "\f0e4";  /* 检测图标 */
            color: #e67e22;
        }

        #menuItem3 h2::before {
            content: "\f5eb";  /* 决策图标 */
            color: #e74c3c;
        }

        #menuItemReportGen h2::before {
            content: "\f15c";  /* 报告图标 */
            color: #9b59b6;
        }

        /* 修改子菜单项样式 */
        .sidebar .menu-item li {
            padding: 10px 15px 10px 45px;
            color: #4a5568;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 6px;
            margin: 2px 0;
            position: relative;
        }

        /* 为子菜单项添加小图标 */
        .sidebar .menu-item li::before {
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            content: "\f105";  /* 箭头图标 */
            position: absolute;
            left: 25px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* 悬停效果 */
        .sidebar .menu-item h2:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            transform: translateX(5px);
        }

        .sidebar .menu-item li:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            transform: translateX(5px);
        }

        /* 活动状态样式 */
        .sidebar .menu-item.active h2 {
            background: rgba(52, 152, 219, 0.15);
            color: #3498db;
        }

        /* 滚动条样式 */
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(52, 152, 219, 0.3);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(52, 152, 219, 0.5);
        }

        /* 主内容区域样式 */
        .main-content {
            padding: 25px;
            height: calc(100vh - 20px);
            overflow-y: auto;
            overflow-x: hidden;
            margin: 10px;
            margin-left: 22px;
            background: linear-gradient(135deg, #f8faff 0%, #f0f5ff 100%);
            border-radius: 15px;
            box-shadow: -2px 0 15px rgba(0, 0, 0, 0.05);
            flex: 1;
            max-width: calc(100vw - 280px);
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* 修改页眉样式，使其与侧边栏风格一致 */
        header {
            background: linear-gradient(135deg, #e8eef9 0%, #d4e2f9 100%);
            color: #2c3e50;
            padding: 10px 20px;
            width: 100%;
            display: flex;
            flex-direction: column;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-top: 0;
            margin-bottom: 15px;
            z-index: 1;
            flex-shrink: 0;
        }

        /* 导航栏样式 */
        .navbar {
            display: flex;
            justify-content: flex-end;
            grid-column: 1 / -1;
        }

        .nav-list {
            display: flex;
            list-style: none;
            margin: 5px;
            padding: 10px;
            gap: 20px;
        }

        .nav-item {
            margin: 0;
        }

        .nav-item a {
            color: #2c3e50;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 16px;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.7);
        }

        .nav-item a:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            transform: translateY(-2px);
        }

        .nav-item a i {
            font-size: 18px;
        }

        /* 添加图标悬停效果 */
        .nav-item a:hover i {
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-3px);
            }
        }

        /* 储氢罐选择器面板样式 */
        .tank-selector-panel {
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            border-radius: 15px;
            padding: 17px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            flex-shrink: 0;
            height: 85%;
        }

        .tank-selector-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 18px;
            color: #2c3e50;
            font-weight: 600;
        }

        .tank-selector-buttons {
            display: flex;
            gap: 25px;
            padding: 13px 0;
        }

        .tank-btn {
            padding: 12px 24px;
            border: 1px solid #e0e6ed;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #4a5568;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 15px;
            font-weight: 500;
            min-width: 150px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .tank-btn::before {
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            content: "\f52c"; /* 储氢罐图标 */
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .tank-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.2);
            border-color: #3498db;
        }

        .tank-btn:active {
            transform: scale(0.95);
        }

        .tank-btn.active {
            background: linear-gradient(145deg, #3498db, #2980b9);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .tank-btn.active::before {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
            }
        }

        .tank-btn span {
            font-family: "Microsoft YaHei", sans-serif;
            letter-spacing: 1px;
            font-size: 15px;
            font-weight: 500;
        }

        .tank-selector-buttons {
            display: flex;
            gap: 20px;
            padding: 10px;
        }

        .tank-selector-title {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e6ed;
        }

        .tank-selector-title i {
            font-size: 24px;
            color: #3498db;
        }

        .tank-selector-title span {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            letter-spacing: 1px;
        }

        /* 状态显示面板样式 */
        .status-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
            width: 100%;
            box-sizing: border-box;
            flex-shrink: 0;
            height: 85%;
        }

        .status-item {
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            padding: 13px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }

        .status-item:hover {
            transform: translateY(-3px);
        }

        .status-label {
            color: #718096;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .status-value {
            color: #2d3748;
            font-size: 24px;
            font-weight: 600;
        }

        /* 实时监测图表面板样式 */
        .realtime-charts-panel {
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            border-radius: 15px;
            padding: 17px;
            margin-bottom: 0;
            overflow: hidden;
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            width: 100%;
            box-sizing: border-box;
            height: calc(35vh * 0.85);
        }

        .panel-header {
            margin-bottom: 20px;
        }

        .panel-header h3 {
            color: #2c3e50;
            font-size: 20px;
            margin: 0;
        }

        .charts-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
            height: 85%;
        }

        .chart-item {
            background: linear-gradient(145deg, #f8faff, #ffffff);
            border-radius: 12px;
            padding: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
            width: 100%;
            box-sizing: border-box;
        }

        .chart-title {
            color: #4a5568;
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .chart-content {
            height: 153px;
            width: 100%;
            min-width: 0;
        }

        /* 氢储罐信息登记面板样式 */
        .tank-info-panel {
            margin-top: auto;
            position: relative;
            background: transparent;
            border-radius: 15px;
            padding: 20px;
            box-shadow: none;
            transition: all 0.3s ease;
            align-self: flex-end;
            width: 100%;
            overflow: hidden;
        }

        .tank-info-content {
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease-out;
            position: fixed;
            top: 0;
            left: 250px;
            right: 20px;
            height: 70vh;
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            z-index: 100;
            transform: translateY(-100%);
            opacity: 0;
            margin-top: 20px;
            margin-left: 20px;
        }

        .tank-info-content.expanded {
            transform: translateY(0);
            opacity: 1;
            max-height: 70vh;
        }

        .toggle-btn {
            background: #f8f9fa;
            transition: transform 0.3s ease;
        }

        .toggle-btn.active {
            transform: rotate(180deg);
        }

        /* 添加动画效果 */
        @keyframes slideDown {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .tank-info-content.expanded .tank-info-table {
            animation: slideDown 0.3s ease-out;
        }

        .tank-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            margin: 0;
            margin-bottom: 10px;
        }

        /* 按钮组样式 */
        .tank-info-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .import-btn {
            background: #28a745;
            color: white;
        }

        .export-btn {
            background: #17a2b8;
            color: white;
        }

        .add-btn {
            background: #007bff;
            color: white;
        }

        /* 下拉菜单样式 */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background: white;
            min-width: 160px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 6px;
            z-index: 1000;
        }

        .dropdown-content a {
            color: #333;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            transition: all 0.3s ease;
        }

        .dropdown-content a:hover {
            background: #f8f9fa;
            color: #007bff;
        }

        .show {
            display: block;
        }

        /* 修改储氢罐信息列表面板样式 */
        .tank-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            margin: 0;
            margin-bottom: 10px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-left h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0;
            font-size: 18px;
            color: #2c3e50;
        }

        .header-left i {
            color: #3498db;
            font-size: 20px;
        }

        .total-info {
            color: #666;
            font-size: 14px;
        }

        .tank-info-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .import-btn {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
            color: white;
        }

        .export-btn {
            background: linear-gradient(145deg, #3498db, #2980b9);
            color: white;
        }

        .add-btn {
            background: linear-gradient(145deg, #9b59b6, #8e44ad);
            color: white;
        }

        .menu-btn {
            background: #f8f9fa;
            color: #666;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* 下拉菜单样式 */
        .dropdown {
            position: relative;
        }

        .dropdown-content {
            position: absolute;
            right: 0;
            top: 100%;
            background: white;
            min-width: 160px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 6px;
            display: none;
            z-index: 1000;
        }

        .dropdown-content a {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #666;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .dropdown-content a:hover {
            background: #f8f9fa;
            color: #3498db;
        }

        .show {
            display: block;
        }

        /* 模态框样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            position: relative;
            background: white;
            margin: 10% auto;
            padding: 20px;
            width: 500px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }

        .modal-header h3 {
            margin: 0;
            color: #2c3e50;
        }

        .close {
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #4a5568;
            font-weight: 500;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .save-btn {
            background: #3498db;
            color: white;
        }

        .cancel-btn {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* 添加媒体查询以处理较小屏幕 */
        @media screen and (max-width: 1400px) {
            .charts-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media screen and (max-width: 1000px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        /* 修改主内容区域的布局比例 */
        .realtime-charts-panel {
            height: 35vh;
            margin-bottom: 7px;
            overflow: hidden;
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            width: 100%;
            box-sizing: border-box;
        }

        .chart-content {
            height: 180px;
        }

        /* 修改储氢罐信息面板样式 */
        .tank-info-panel {
            height: auto;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            background: linear-gradient(145deg, #ffffff, #f5f8ff);
            border-radius: 15px;
            padding: 20px;
            margin-top: 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            overflow: visible;
        }

        /* 修改表格容器样式 */
        .tank-info-table {
            border-radius: 15px;
            overflow: hidden;
            height: calc(100% - 60px);
            padding: 20px;
        }

        /* 修改表格头部样式 */
        .tank-info-table thead th:first-child {
            border-top-left-radius: 10px;
        }

        .tank-info-table thead th:last-child {
            border-top-right-radius: 10px;
        }

        /* 修改表格底部样式 */
        .tank-info-table tbody tr:last-child td:first-child {
            border-bottom-left-radius: 10px;
        }

        .tank-info-table tbody tr:last-child td:last-child {
            border-bottom-right-radius: 10px;
        }

        /* 添加遮罩层 */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 99;
        }

        .overlay.active {
            display: block;
        }

        /* 调整上方面板的高度 */
        .tank-selector-panel {
            height: auto;
            min-height: 100px;
            margin-bottom: 15px;
        }

        .status-panel {
            height: auto;
            min-height: 80px;
            margin-bottom: 15px;
        }

        /* ���化表格样式 */
        .tank-info-table table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .tank-info-table thead {
            position: sticky;
            top: 0;
            z-index: 1;
            background: #f8fafc;
        }

        /* 美化滚动条 */
        .tank-info-table::-webkit-scrollbar {
            width: 6px;
        }

        .tank-info-table::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .tank-info-table::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .tank-info-table::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* 调整实时监测图表面板的高度 */
        .realtime-charts-panel {
            height: calc(35vh * 0.85);
            margin-bottom: 0;
            overflow: hidden;
            padding: 17px;
            flex-shrink: 0;
        }

        /* 调整主内容区域的布局 */
        .main-content {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            gap: 0;
        }

        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .message.success {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
        }

        .message.error {
            background: linear-gradient(145deg, #e74c3c, #c0392b);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 500;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            outline: none;
        }

        .form-group input:hover,
        .form-group select:hover {
            border-color: #3498db;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .form-actions button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .form-actions button:hover {
            transform: translateY(-2px);
        }

        .save-btn {
            background: linear-gradient(145deg, #3498db, #2980b9);
            color: white;
        }

        .cancel-btn {
            background: #e2e8f0;
            color: #4a5568;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .required {
            color: #e74c3c;
            margin-left: 4px;
        }

        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }

        .form-group textarea:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            outline: none;
        }

        /* 修改模态框样式 */
        .modal-content {
            width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-body {
            padding: 20px;
        }

        /* 添加输入验证样式 */
        .form-group input:invalid,
        .form-group select:invalid {
            border-color: #e74c3c;
        }

        .form-group input:invalid:focus,
        .form-group select:invalid:focus {
            box-shadow: 0 0 0 2px rgba(231, 76, 60, 0.2);
        }

        /* 修改储氢罐信息表格内容部分 */
        .tank-info-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .tank-info-content.expanded {
            max-height: 500px;
        }

        .toggle-btn i {
            transition: transform 0.3s ease;
        }

        .toggle-btn.active i {
            transform: rotate(180deg);
        }

        .tank-info-table table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 15px;
        }

        .tank-info-table th,
        .tank-info-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .tank-info-table th {
            background: #f8fafc;
            font-weight: 600;
            color: #2c3e50;
        }

        .tank-info-table tr:hover {
            background: #f8fafc;
        }

        .tank-info-table .edit-btn,
        .tank-info-table .delete-btn {
            padding: 6px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 2px;
        }

        .tank-info-table .edit-btn {
            background: #ffc107;
            color: #000;
        }

        .tank-info-table .delete-btn {
            background: #dc3545;
            color: white;
        }

        .status-normal {
            color: #28a745;
            background: rgba(40, 167, 69, 0.1);
            padding: 4px 8px;
            border-radius: 4px;
        }

        /* 创建一个容器来包含上方的面板 */
        .upper-panels {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
    </style>
</head>
<body>
    <!-- 边栏部分 -->
    <div class="sidebar">
        <div class="menu-item" id="menuItem0">
            <div class="menu-item-wrap">
                <h2>船舶管理</h2>
                <ul id="menu0">
                    <li onclick="window.location.href='船舶信息管理.html'">船舶信息</li>
                </ul>
            </div>
        </div>

        <div class="menu-item" id="menuItem1">
            <div class="menu-item-wrap">
                <h2>信息记录</h2>
                <ul id="menu1">
                    <li onclick="window.location.href='日报记录.html'">日报记录</li>
                    <li onclick="window.location.href='航次记录.html'">航次记录</li>
                    <li onclick="window.location.href='储氢罐记录.html'">储氢罐记录</li>
                    <li onclick="window.location.href='加氢记录.html'">加氢记录</li>
                    <li onclick="window.location.href='在线监测记录.html'">在线监测记录</li>
                </ul>
            </div>
        </div>
        
        <div class="menu-item" id="menuItem2">
            <div class="menu-item-wrap">
                <h2>能效分析</h2>
                <ul id="menu2">
                    <li onclick="window.location.href='能耗统计.html'">能耗统计</li>
                    <li onclick="window.location.href='性能分析.html'">性能分析</li>
                    <li onclick="window.location.href='能效计算器.html'">能效计算器</li>
                    <li onclick="window.location.href='能效提升预测.html'">能效提升预测</li>
                </ul>
            </div>
        </div>
        
        <div class="menu-item" id="menuItem3">
            <div class="menu-item-wrap">
                <h2>报表管理</h2>
                <ul id="menu3">
                    <li onclick="window.location.href='能耗记录表.html'">能耗记录表</li>
                    <li onclick="window.location.href='能效管理计划.html'">能效管理计划</li>
                    <li onclick="window.location.href='自定义报表.html'">自定义报表</li>
                </ul>
            </div>
        </div>
        
        <div class="menu-item" id="menuItemReportGen">
            <div class="menu-item-wrap">
                <h2>在职人员管理</h2>
                <ul id="reportGen">
                    <li onclick="window.location.href='在职人员信息.html'">在职人员信息</li>
                    <li onclick="window.location.href='当��记录表.html'">当值记录表</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 主内容区域 -->
    <div class="main-content">
        <!-- 页眉部分 -->
        <header>
            <div class="header-content">
                <nav class="navbar">
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" title="页">
                                <i class="fas fa-home"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" title="数据分析">
                                <i class="fas fa-chart-line"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" title="设置">
                                <i class="fas fa-cog"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" title="用户">
                                <i class="fas fa-user"></i>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- 储氢罐选择器面板 -->
        <div class="tank-selector-panel">
            <div class="tank-selector-title">
                <i class="fas fa-database"></i>
                <span>储氢罐选择</span>
            </div>
            <div class="tank-selector-buttons">
                <button class="tank-btn active" data-tank="1">
                    <span>储氢罐 1</span>
                </button>
                <button class="tank-btn" data-tank="2">
                    <span>储氢罐 2</span>
                </button>
                <button class="tank-btn" data-tank="3">
                    <span>储氢罐 3</span>
                </button>
                <button class="tank-btn" data-tank="4">
                    <span>储氢罐 4</span>
                </button>
            </div>
        </div>

        <!-- 状态显示面板 -->
        <div class="status-panel">
            <div class="status-item">
                <div class="status-label">当前船名</div>
                <div class="status-value" id="currentShipName">测试船舶001</div>
            </div>
            <div class="status-item">
                <div class="status-label">当前船速</div>
                <div class="status-value" id="currentSpeed">12.5 节</div>
            </div>
            <div class="status-item">
                <div class="status-label">储氢罐压力</div>
                <div class="status-value" id="currentPressure">350 bar</div>
            </div>
            <div class="status-item">
                <div class="status-label">氢气流</div>
                <div class="status-value" id="currentFlow">2.5 kg/h</div>
            </div>
        </div>

        <!-- 实时监测图表面 -->
        <div class="realtime-charts-panel">
            <div class="panel-header">
                <h3>储氢罐实时监测数</h3>
            </div>
            <div class="charts-container">
                <div class="chart-item">
                    <div class="chart-title">温度变化曲线</div>
                    <div id="temperatureChart" class="chart-content"></div>
                </div>
                <div class="chart-item">
                    <div class="chart-title">压力变化曲线</div>
                    <div id="pressureChart" class="chart-content"></div>
                </div>
                <div class="chart-item">
                    <div class="chart-title">氢气流量曲线</div>
                    <div id="flowChart" class="chart-content"></div>
                </div>
            </div>
        </div>

        <!-- 在主内容区域的最后添加氢储罐信息登记面板 -->
        <div class="tank-info-panel">
            <div class="tank-info-header">
                <div class="header-left">
                    <h3><i class="fas fa-database"></i> 储氢罐信息列表</h3>
                    <div class="total-info">
                        共 <span id="totalRecords">0</span> 条记录
                    </div>
                </div>
                <div class="tank-info-actions">
                    <button class="action-btn import-btn" onclick="importTankInfo()">
                        <i class="fas fa-file-import"></i>
                        导入信息
                    </button>
                    <button class="action-btn export-btn" onclick="exportTankInfo()">
                        <i class="fas fa-file-export"></i>
                        导出信息
                    </button>
                    <button class="action-btn add-btn" onclick="showAddTankDialog()">
                        <i class="fas fa-plus"></i>
                        手动输入
                    </button>
                    <button class="action-btn toggle-btn" onclick="toggleInfoPanel()">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
            </div>
            <div class="tank-info-content" id="tankInfoContent">
                <div class="tank-info-table">
                    <table>
                        <thead>
                            <tr>
                                <th>储氢罐编号</th>
                                <th>所属船舶</th>
                                <th>最大容量(kg)</th>
                                <th>氢储量(kg)</th>
                                <th>额定压力(MPa)</th>
                                <th>当前压力(MPa)</th>
                                <th>额定温度(℃)</th>
                                <th>当前温度(℃)</th>
                                <th>氢气纯度(%)</th>
                                <th>使用状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="tankInfoTableBody">
                            <tr>
                                <td>HT-001</td>
                                <td>测试船舶001</td>
                                <td>500</td>
                                <td>350</td>
                                <td>35</td>
                                <td>32.5</td>
                                <td>25</td>
                                <td>23.5</td>
                                <td>99.99</td>
                                <td><span class="status-normal">正常使用</span></td>
                                <td>
                                    <button class="edit-btn" onclick="editRecord(1)">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn" onclick="deleteRecord(1)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <!-- 可以添加更多行 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 在body标签结束前添加模态框 -->
    <div id="tankModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">新增储氢罐信息</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="tankForm">
                    <div class="form-group">
                        <label>储氢罐编号 <span class="required">*</span></label>
                        <input type="text" id="tankId" required placeholder="请输入储氢罐编号">
                    </div>
                    <div class="form-group">
                        <label>所属船舶 <span class="required">*</span></label>
                        <input type="text" id="shipName" required placeholder="请输入所属船舶">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>额定容量(kg) <span class="required">*</span></label>
                            <input type="number" id="maxCapacity" required placeholder="请输入容量">
                        </div>
                        <div class="form-group">
                            <label>当前储量(kg) <span class="required">*</span></label>
                            <input type="number" id="currentCapacity" required placeholder="请输入当前储量">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>额定压力(MPa) <span class="required">*</span></label>
                            <input type="number" id="workingPressure" required placeholder="请输入工作压力">
                        </div>
                        <div class="form-group">
                            <label>当前压力(MPa)</label>
                            <input type="number" id="currentPressure" placeholder="请输入当前压力">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>额定温度(℃) <span class="required">*</span></label>
                            <input type="number" id="workingTemp" required placeholder="请输入工作温度">
                        </div>
                        <div class="form-group">
                            <label>当前温度(℃)</label>
                            <input type="number" id="currentTemp" placeholder="请输入当前温度">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>氢气纯度(%) <span class="required">*</span></label>
                            <input type="number" id="hydrogenPurity" required min="0" max="100" placeholder="请输入氢气纯度">
                        </div>
                        <div class="form-group">
                            <label>使用状态 <span class="required">*</span></label>
                            <select id="status" required>
                                <option value="">请选择使用状态</option>
                                <option value="normal">正常使用</option>
                                <option value="maintenance">维护中</option>
                                <option value="fault">故障</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>备注</label>
                        <textarea id="remarks" rows="3" placeholder="请输入备注信息"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn save-btn" onclick="saveTankInfo()">保存</button>
                <button class="btn cancel-btn" onclick="closeModal()">取消</button>
            </div>
        </div>
    </div>

    <script>
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 为所有菜单项的包装器添加点击事件
            document.querySelectorAll('.menu-item-wrap').forEach(wrap => {
                wrap.addEventListener('click', function(e) {
                    // 阻止事件冒泡
                    e.stopPropagation();
                    
                    // 获取当前菜单项
                    const menuItem = this.closest('.menu-item');
                    
                    // 关闭其他菜单
                    document.querySelectorAll('.menu-item').forEach(item => {
                        if (item !== menuItem && item.classList.contains('active')) {
                            item.classList.remove('active');
                        }
                    });
                    
                    // 切换当前菜单
                    menuItem.classList.toggle('active');
                });
            });

            // 阻止菜单项点击事件冒泡
            document.querySelectorAll('.menu-item ul li').forEach(li => {
                li.addEventListener('click', function(e) {
                    e.stopPropagation();
                });
            });

            // 初始化其他功能...
            if (typeof echarts !== 'undefined') {
                initCharts();
            }

            // 初始化储氢罐选择按钮
            document.querySelectorAll('.tank-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tankId = this.getAttribute('data-tank');
                    switchTank(parseInt(tankId));
                });
            });

            // 默认选中第一个储氢罐
            switchTank(1);
        });

        // 切换储氢罐
        function switchTank(tankId) {
            document.querySelectorAll('.tank-btn').forEach(btn => {
                btn.classList.remove('active');
                if (parseInt(btn.getAttribute('data-tank')) === tankId) {
                    btn.classList.add('active');
                }
            });
            // 更新图表数据
            updateCharts(tankId);
        }

        // 初始化图表
        function initCharts() {
            // 温度进度条
            const temperatureChart = echarts.init(document.getElementById('temperatureChart'));
            const temperatureOption = {
                title: {
                    text: '温度监测',
                    left: 'center'
                },
                tooltip: {
                    formatter: '{c}°C'
                },
                grid: {
                    left: '15%',
                    right: '15%',
                    bottom: '20%',
                    top: '60'
                },
                xAxis: {
                    show: false,
                    max: 50  // 设置最大值为50°C
                },
                yAxis: {
                    type: 'category',
                    data: [],
                    axisLine: { show: false },
                    axisTick: { show: false }
                },
                series: [{
                    type: 'bar',
                    data: [25],
                    barWidth: '30%',
                    label: {
                        show: true,
                        position: 'right',
                        formatter: '{c}°C'
                    },
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                            offset: 0,
                            color: '#FF4500'
                        }, {
                            offset: 1,
                            color: '#ff7043'
                        }])
                    }
                }]
            };
            temperatureChart.setOption(temperatureOption);

            // 压力进度条
            const pressureChart = echarts.init(document.getElementById('pressureChart'));
            const pressureOption = {
                title: {
                    text: '压力监测',
                    left: 'center'
                },
                tooltip: {
                    formatter: '{c}MPa'
                },
                grid: {
                    left: '15%',
                    right: '15%',
                    bottom: '20%',
                    top: '60'
                },
                xAxis: {
                    show: false,
                    max: 40  // 设置最大值为40MPa
                },
                yAxis: {
                    type: 'category',
                    data: [],
                    axisLine: { show: false },
                    axisTick: { show: false }
                },
                series: [{
                    type: 'bar',
                    data: [30],
                    barWidth: '30%',
                    label: {
                        show: true,
                        position: 'right',
                        formatter: '{c}MPa'
                    },
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                            offset: 0,
                            color: '#4169E1'
                        }, {
                            offset: 1,
                            color: '#1E90FF'
                        }])
                    }
                }]
            };
            pressureChart.setOption(pressureOption);

            // 流量进度条
            const flowChart = echarts.init(document.getElementById('flowChart'));
            const flowOption = {
                title: {
                    text: '氢气流量监测',
                    left: 'center'
                },
                tooltip: {
                    formatter: '{c}kg/h'
                },
                grid: {
                    left: '15%',
                    right: '15%',
                    bottom: '20%',
                    top: '60'
                },
                xAxis: {
                    show: false,
                    max: 5  // 设置最大值为5kg/h
                },
                yAxis: {
                    type: 'category',
                    data: [],
                    axisLine: { show: false },
                    axisTick: { show: false }
                },
                series: [{
                    type: 'bar',
                    data: [2.5],
                    barWidth: '30%',
                    label: {
                        show: true,
                        position: 'right',
                        formatter: '{c}kg/h'
                    },
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                            offset: 0,
                            color: '#32CD32'
                        }, {
                            offset: 1,
                            color: '#90EE90'
                        }])
                    }
                }]
            };
            flowChart.setOption(flowOption);

            // 定时更新数据
            setInterval(() => {
                updateCharts(temperatureChart, pressureChart, flowChart);
            }, 2000);

            // 窗口大小改变时自动调整图表大小
            window.addEventListener('resize', () => {
                temperatureChart.resize();
                pressureChart.resize();
                flowChart.resize();
            });
        }

        // 更新图表数据
        function updateCharts(temperatureChart, pressureChart, flowChart) {
            // 更新温度数据
            const temperature = Math.random() * 10 + 25; // 25-35℃
            temperatureChart.setOption({
                series: [{
                    data: [temperature.toFixed(1)]
                }]
            });

            // 更新压力数据
            const pressure = Math.random() * 5 + 30; // 30-35MPa
            pressureChart.setOption({
                series: [{
                    data: [pressure.toFixed(1)]
                }]
            });

            // 更新流量数据
            const flow = Math.random() * 2 + 1; // 1-3kg/h
            flowChart.setOption({
                series: [{
                    data: [flow.toFixed(2)]
                }]
            });
        }

        // 初始化侧边栏菜单
        function initSidebarMenus() {
            // 与日报记录.html相同的侧边栏初始化代码
        }

        // 菜单切换函数
        function toggleMenuItem(menuId) {
            const menuItems = document.querySelectorAll('.menu-item');
            const targetMenuItem = document.getElementById(menuId).closest('.menu-item');
            
            if (targetMenuItem.classList.contains('active')) {
                targetMenuItem.classList.remove('active');
                const subMenu = targetMenuItem.querySelector('ul');
                if (subMenu) {
                    subMenu.style.maxHeight = '0';
                }
                return;
            }
            
            // 关闭其他打开的菜单项
            menuItems.forEach(item => {
                if (item !== targetMenuItem) {
                    item.classList.remove('active');
                    const subMenu = item.querySelector('ul');
                    if (subMenu) {
                        subMenu.style.maxHeight = '0';
                    }
                }
            });
            
            // 打开目标菜单项
            targetMenuItem.classList.add('active');
            const subMenu = targetMenuItem.querySelector('ul');
            if (subMenu) {
                subMenu.style.maxHeight = subMenu.scrollHeight + 'px';
            }
        }

        function showAddTankDialog() {
            const modal = document.getElementById('tankModal');
            const modalTitle = document.getElementById('modalTitle');
            modalTitle.textContent = '新增储氢罐信息';
            
            // 清空表单
            clearForm();
            
            // 显示模态框
            modal.style.display = 'block';
        }

        function editTankInfo(id) {
            // 编辑储氢罐信息
            console.log('编辑储氢罐信息:', id);
        }

        function deleteTankInfo(id) {
            // 删储罐信息
            if (confirm('确定要删除这条储���罐信息吗？')) {
                console.log('删除储氢罐信息:', id);
            }
        }

        // 导入储氢罐信息
        function importTankInfo() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.xlsx,.xls,.csv';
            input.onchange = function(e) {
                const file = e.target.files[0];
                // 这里添加文件处理逻辑
                console.log('导入文件:', file.name);
            };
            input.click();
        }

        // 导出储氢罐信息
        function exportTankInfo() {
            // 这添加导出逻辑
            console.log('导出储氢罐信息');
        }

        // 切换下拉菜单
        function toggleDropdown() {
            document.getElementById('tankDropdown').classList.toggle('show');
        }

        // 刷新列表
        function refreshList() {
            // 这里添加刷新列的逻辑
            console.log('刷新列表');
        }

        // 显示筛选选项
        function showFilter() {
            // 这里添加显示筛选选项的逻辑
            console.log('显示筛选选项');
        }

        // 显示设置
        function showSettings() {
            // 这里添加显示设置的逻辑
            console.log('显示设置');
        }

        // 点击其他地方关闭下拉菜单
        window.onclick = function(event) {
            if (!event.target.matches('.menu-btn')) {
                const dropdowns = document.getElementsByClassName('dropdown-content');
                for (let dropdown of dropdowns) {
                    if (dropdown.classList.contains('show')) {
                        dropdown.classList.remove('show');
                    }
                }
            }
        }

        // 储氢罐信息表格相关功能
        function initTableFunctions() {
            // 初始化表格排序功能
            const tableHeaders = document.querySelectorAll('th[data-sort]');
            tableHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const column = header.dataset.sort;
                    sortTable(column);
                });
            });

            // 初始化表格筛选功能
            initTableFilter();
        }

        // 表格筛选功能
        function initTableFilter() {
            const filterInputs = document.querySelectorAll('.filter-input');
            filterInputs.forEach(input => {
                input.addEventListener('input', () => {
                    filterTable();
                });
            });
        }

        // 导出表格数据为Excel
        function exportToExcel() {
            // 这里添加导出Excel的逻辑
            console.log('导出Excel文件');
            alert('开始导出Excel文件');
        }

        // 导入Excel数据
        function importFromExcel(file) {
            // 这里添加导入Excel的逻辑
            console.log('导入Excel文件:', file.name);
            alert('开始导入Excel文件');
        }

        // 添加新的储氢罐记录
        function addNewRecord() {
            // 显示添加记录的模态框
            const modal = document.getElementById('addRecordModal');
            if (modal) {
                modal.style.display = 'block';
            }
        }

        // 编辑现有记录
        function editRecord(id) {
            // 显示编辑记录的模态框
            console.log('编辑记录:', id);
            // 加载记��数据
            loadRecordData(id);
        }

        // 删除记录
        function deleteRecord(id) {
            if (confirm('确定要删除这记录吗？')) {
                console.log('删除记录:', id);
                // 执行删除操作
                // 刷新表格
                refreshTable();
            }
        }

        // 刷新表格数据
        function refreshTable() {
            // 这里添加刷新表格的逻辑
            console.log('刷新表格数据');
            loadTableData();
        }

        // 表格分页功能
        function initPagination() {
            const pageSize = 10; // 每页显示的记录数
            let currentPage = 1;
            
            function updatePagination() {
                // 更新分页控件
                document.getElementById('currentPage').textContent = currentPage;
                // 更新表格显示
                updateTableDisplay();
            }
            
            function updateTableDisplay() {
                // 根据当前页码显示相应的记录
                const rows = document.querySelectorAll('#tankInfoTableBody tr');
                rows.forEach((row, index) => {
                    const shouldShow = index >= (currentPage - 1) * pageSize && index < currentPage * pageSize;
                    row.style.display = shouldShow ? '' : 'none';
                });
            }
        }

        // 加载表格数据
        function loadTableData() {
            // 这里添加从服务器加载数据的逻辑
            console.log('加载表格数据');
        }

        // 加载记录数据
        function loadRecordData(id) {
            // 这里添加加载特定记录的逻辑
            console.log('加载记录数据:', id);
        }

        // 初始化所有功能
        document.addEventListener('DOMContentLoaded', function() {
            initTableFunctions();
            initPagination();
            
            // 添加表格行悬停效果
            const tableRows = document.querySelectorAll('#tankInfoTableBody tr');
            tableRows.forEach(row => {
                row.addEventListener('mouseenter', () => {
                    row.style.backgroundColor = '#f5f8ff';
                });
                row.addEventListener('mouseleave', () => {
                    row.style.backgroundColor = '';
                });
            });
        });

        // 添加模态框相关函数
        function showModal(type, id = null) {
            const modal = document.getElementById('tankModal');
            const title = document.getElementById('modalTitle');
            
            if (type === 'add') {
                title.textContent = '新增储氢罐信息';
                clearForm();
            } else {
                title.textContent = '编辑储氢罐信息';
                loadTankInfo(id);
            }
            
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('tankModal').style.display = 'none';
        }

        function clearForm() {
            document.getElementById('tankForm').reset();
        }

        function loadTankInfo(id) {
            // 这里添加加载储氢罐信息的逻辑
            console.log('加载储氢罐信息:', id);
        }

        function saveTankInfo() {
            const formData = {
                tankId: document.getElementById('tankId').value,
                shipName: document.getElementById('shipName').value,
                maxCapacity: document.getElementById('maxCapacity').value,
                currentCapacity: document.getElementById('currentCapacity').value,
                workingPressure: document.getElementById('workingPressure').value,
                currentPressure: document.getElementById('currentPressure').value,
                workingTemp: document.getElementById('workingTemp').value,
                currentTemp: document.getElementById('currentTemp').value,
                hydrogenPurity: document.getElementById('hydrogenPurity').value,
                status: document.getElementById('status').value,
                remarks: document.getElementById('remarks').value
            };

            // 验证必填字段
            if (!validateForm(formData)) {
                return;
            }

            // 添加新行到表格
            const tableBody = document.getElementById('tankInfoTableBody');
            const newRow = document.createElement('tr');
            
            // 设置新行的HTML内容
            newRow.innerHTML = `
                <td>${formData.tankId}</td>
                <td>${formData.shipName}</td>
                <td>${formData.maxCapacity}</td>
                <td>${formData.currentCapacity}</td>
                <td>${formData.workingPressure}</td>
                <td>${formData.currentPressure || '-'}</td>
                <td>${formData.workingTemp}</td>
                <td>${formData.currentTemp || '-'}</td>
                <td>${formData.hydrogenPurity}</td>
                <td><span class="status-normal">${getStatusText(formData.status)}</span></td>
                <td>
                    <button class="edit-btn" onclick="editRecord('${formData.tankId}')">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="delete-btn" onclick="deleteRecord('${formData.tankId}')">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            `;

            // 将新行添加到表格开头
            tableBody.insertBefore(newRow, tableBody.firstChild);

            // 更新记录总数
            updateTotalRecords();
            
            // 显示成功提示
            showMessage('储氢罐信息保存成功');
            
            // 关闭模态框
            closeModal();
        }

        // 添加获取状态文本的辅助函数
        function getStatusText(status) {
            const statusMap = {
                'normal': '正常使用',
                'maintenance': '维护中',
                'fault': '故障'
            };
            return statusMap[status] || status;
        }

        // 添加更新记录总数的函数
        function updateTotalRecords() {
            const totalRecords = document.getElementById('tankInfoTableBody').getElementsByTagName('tr').length;
            document.getElementById('totalRecords').textContent = totalRecords;
        }

        // 修改 clearForm 函数
        function clearForm() {
            document.getElementById('tankForm').reset();
            // 确保状态选择框重置为默认选项
            document.getElementById('status').value = '';
        }

        // 修改 closeModal 函数
        function closeModal() {
            const modal = document.getElementById('tankModal');
            modal.style.display = 'none';
            clearForm(); // 关闭时清空表单
        }

        // 点击模态框外部关闭
        window.onclick = function(event) {
            const modal = document.getElementById('tankModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        function toggleInfoPanel() {
            const content = document.getElementById('tankInfoContent');
            const toggleBtn = document.querySelector('.toggle-btn');
            const overlay = document.querySelector('.overlay');
            
            content.classList.toggle('expanded');
            toggleBtn.classList.toggle('active');
            
            if (content.classList.contains('expanded')) {
                // 显示遮罩层
                overlay.classList.add('active');
                // 禁止背景滚动
                document.body.style.overflow = 'hidden';
                
                // 展开内容
                content.style.display = 'block';
                setTimeout(() => {
                    content.style.transform = 'translateY(0)';
                    content.style.opacity = '1';
                }, 10);
            } else {
                // 隐藏内容
                content.style.transform = 'translateY(-100%)';
                content.style.opacity = '0';
                
                // 移除遮罩层
                overlay.classList.remove('active');
                // 恢复背景滚动
                document.body.style.overflow = 'auto';
                
                // 等待动画完成后隐藏
                setTimeout(() => {
                    content.style.display = 'none';
                }, 300);
            }
        }

        // 添加点击遮罩层关闭面板的功能
        document.addEventListener('DOMContentLoaded', function() {
            // 添加遮罩层到DOM
            const overlay = document.createElement('div');
            overlay.className = 'overlay';
            document.body.appendChild(overlay);
            
            // 点击遮罩层关闭面板
            overlay.addEventListener('click', function() {
                const content = document.getElementById('tankInfoContent');
                const toggleBtn = document.querySelector('.toggle-btn');
                
                if (content.classList.contains('expanded')) {
                    content.classList.remove('expanded');
                    toggleBtn.classList.remove('active');
                    this.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
            });
        });

        // 添加表单验证函数
        function validateForm(data) {
            const requiredFields = {
                tankId: '储氢罐编号',
                shipName: '所属船舶',
                maxCapacity: '最大容量',
                currentCapacity: '当前储量',
                workingPressure: '工作压力',
                workingTemp: '工作温度',
                hydrogenPurity: '氢气纯度',
                status: '使用状态'
            };

            for (const [field, label] of Object.entries(requiredFields)) {
                if (!data[field]) {
                    showMessage(`请输入${label}`, 'error');
                    return false;
                }
            }

            // 数值验证
            if (parseFloat(data.currentCapacity) > parseFloat(data.maxCapacity)) {
                showMessage('当前储量不能超过最大容量', 'error');
                return false;
            }

            if (data.hydrogenPurity < 0 || data.hydrogenPurity > 100) {
                showMessage('氢气纯度必须在0-100之间', 'error');
                return false;
            }

            return true;
        }

        // 添加消息提示功能
        function showMessage(message, type = 'success') {
            // 移除现有的消息提示
            const existingMessages = document.querySelectorAll('.message');
            existingMessages.forEach(msg => msg.remove());
            
            // 创建新的消息提示
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            // 3秒后自动消失
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        // 修改 saveTankInfo 函数，添加错误处理
        function saveTankInfo() {
            try {
                const formData = {
                    tankId: document.getElementById('tankId').value,
                    shipName: document.getElementById('shipName').value,
                    maxCapacity: document.getElementById('maxCapacity').value,
                    currentCapacity: document.getElementById('currentCapacity').value,
                    workingPressure: document.getElementById('workingPressure').value,
                    currentPressure: document.getElementById('currentPressure').value,
                    workingTemp: document.getElementById('workingTemp').value,
                    currentTemp: document.getElementById('currentTemp').value,
                    hydrogenPurity: document.getElementById('hydrogenPurity').value,
                    status: document.getElementById('status').value,
                    remarks: document.getElementById('remarks').value
                };

                // 验证必填字段
                if (!validateForm(formData)) {
                    return;
                }

                // 添加新行到表格
                const tableBody = document.getElementById('tankInfoTableBody');
                const newRow = document.createElement('tr');
                
                // 设置新行的HTML内容
                newRow.innerHTML = `
                    <td>${formData.tankId}</td>
                    <td>${formData.shipName}</td>
                    <td>${formData.maxCapacity}</td>
                    <td>${formData.currentCapacity}</td>
                    <td>${formData.workingPressure}</td>
                    <td>${formData.currentPressure || '-'}</td>
                    <td>${formData.workingTemp}</td>
                    <td>${formData.currentTemp || '-'}</td>
                    <td>${formData.hydrogenPurity}</td>
                    <td><span class="status-normal">${getStatusText(formData.status)}</span></td>
                    <td>
                        <button class="edit-btn" onclick="editRecord('${formData.tankId}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="delete-btn" onclick="deleteRecord('${formData.tankId}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;

                // 将新行添加到表格开头
                tableBody.insertBefore(newRow, tableBody.firstChild);

                // 更新记录总数
                updateTotalRecords();
                
                // 显示成功提示
                showMessage('储氢罐信息保存成功');
                
                // 关闭模态框
                closeModal();
                
            } catch (error) {
                console.error('保存储氢罐信息时发生错误:', error);
                showMessage('保存失败，请检查输入数据', 'error');
            }
        }

        // 添加CSS样式
        const style = document.createElement('style');
        style.textContent = `
            .message {
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 8px;
                color: white;
                font-weight: 500;
                z-index: 1000;
                animation: slideIn 0.3s ease;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            }

            .message.success {
                background: linear-gradient(145deg, #2ecc71, #27ae60);
            }

            .message.error {
                background: linear-gradient(145deg, #e74c3c, #c0392b);
            }

            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html> 